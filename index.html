<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Cem Ozturk</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Tinos:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">

<style>
:root{
  --wall:#e6e6e6;
  --wall2:#f2f2f2;
  --paper:#fbfbfb;
  --paper2:#f2f2f2;
  --shadow:0 18px 40px rgba(0,0,0,.22);
  --shadowSoft:0 10px 24px rgba(0,0,0,.16);

  --scale: 1;
  --tx: 0px;
  --ty: 0px;

  --spotX: 50vw;
  --spotY: 50vh;
}

/* Kill Safari selection */
*{
  -webkit-user-select:none;
  user-select:none;
  -webkit-user-drag:none;
}

html,body{
  height:100%;
  margin:0;
}

body{
  overflow:hidden;
  background:
    radial-gradient(900px 700px at 10% 10%, rgba(255,255,255,.75), transparent 60%),
    radial-gradient(800px 600px at 90% 20%, rgba(0,0,0,.08), transparent 55%),
    repeating-linear-gradient(0deg, rgba(0,0,0,.02) 0 2px, transparent 2px 7px),
    linear-gradient(135deg, var(--wall), var(--wall2));
  font-family:"Tinos", serif;
}

/* Viewport wrapper (we zoom the board inside this) */
.viewport{
  position:fixed;
  inset:0;
  overflow:hidden;
}

/* Board */
.board{
  position:absolute;
  inset:0;
  width:100vw;
  height:100vh;
  transform-origin: 0 0;
  transform: translate(var(--tx), var(--ty)) scale(var(--scale));
  transition: transform 420ms cubic-bezier(.22,.61,.36,1);
}

/* Flashlight overlay */
.spotlight{
  position:fixed;
  inset:0;
  opacity:0;
  pointer-events:none;
  transition: opacity 380ms ease;
  z-index: 5000;
  /* “flashlight beam”: bright in center, fades into dark */
  background:
    radial-gradient(circle 160px at var(--spotX) var(--spotY),
      rgba(255,255,255,.95) 0%,
      rgba(255,255,255,.35) 45%,
      rgba(0,0,0,.55) 78%,
      rgba(0,0,0,.78) 100%);
}

.spotlight.on{
  opacity:1;
  pointer-events:auto; /* click-to-exit */
}

/* Docs */
.doc{
  position:absolute;
  transform:rotate(var(--rot));
  transform-origin: var(--pinX) 14px;
  cursor:grab;
  touch-action:none;
}
.doc:active{cursor:grabbing}

/* Pin */
.pin{
  position:absolute;
  top:6px;
  left:var(--pinX);
  transform:translateX(-50%);
  width:16px;
  height:16px;
  border-radius:50%;
  background:var(--pin);
  box-shadow:0 6px 14px rgba(0,0,0,.25);
  pointer-events:none;
  z-index:6;
}
.pin::after{
  content:"";
  position:absolute;
  inset:4px;
  border-radius:50%;
  background:rgba(255,255,255,.55);
}

/* Pin pressure */
.doc--photo::after{
  content:"";
  position:absolute;
  left:var(--pinX);
  top:16px;
  transform:translateX(-50%);
  width:12px;
  height:7px;
  border-radius:999px;
  background:rgba(0,0,0,.16);
  filter:blur(.25px);
  z-index:5;
}

/* Photo */
.doc--photo img{
  display:block;
  width:100%;
  height:100%;
  box-shadow:var(--shadow);
  border:1px solid #000;
}

/* Name card */
.doc--name{
  background:linear-gradient(180deg,var(--paper),var(--paper2));
  border-radius:999px;
  padding:14px 18px 12px;
  box-shadow:var(--shadowSoft);
  text-align:center;
  z-index: 9999; /* always above everything */
}
.doc--name h1,
.doc--name p{ pointer-events:none; }
.doc--name h1{
  margin:0;
  font-size:28px;
  letter-spacing:.08em;
}
.doc--name p{
  margin:4px 0 0;
  font-size:13px;
  opacity:.75;
  font-family:system-ui;
}

.doc.focused{
  filter:brightness(1.12) contrast(1.05);
  cursor:default;
}
.doc.dimmed{opacity:.35}

.hint{
  position:fixed;
  bottom:14px;
  right:14px;
  padding:10px 14px;
  border-radius:999px;
  background:rgba(250,250,250,.9);
  font-size:12px;
  z-index:60;
}
</style>
</head>

<body>

<div class="spotlight" id="spotlight"></div>

<div class="viewport" id="viewport">
  <main class="board" id="board"></main>
</div>

<div class="hint">Drag · Click photo to focus · ESC to exit</div>

<script>
(() => {
  const board = document.getElementById("board");
  const viewport = document.getElementById("viewport");
  const spotlight = document.getElementById("spotlight");

  const clamp=(v,min,max)=>Math.max(min,Math.min(max,v));
  const rand=(a,b)=>Math.random()*(b-a)+a;

  const PIN_X_OPTIONS=["16%","50%","84%"];

  // Z layering: photos go up as you interact, name card stays above all
  let zTop = 100;
  function bringToFront(el){
    if(el.classList.contains("doc--name")) return;
    el.style.zIndex = String(++zTop);
  }

  // --- physics (wiggle) ---
  const phys=new WeakMap();
  const physDocs=new Set();
  let rafOn=false,lastFrame=0;

  function pinPercent(x){return parseFloat(x)||50}
  function pinOffset(x){return Math.abs((pinPercent(x)-50)/34)}

  function gray(){
    const g=Math.floor(rand(45,105));
    return `rgb(${g},${g},${g})`;
  }

  function baseAngle(pinX){
    const off=(pinPercent(pinX)-50)/34;
    return clamp(-off*9.5 + rand(-1,1)*(0.3+Math.abs(off)), -14,14);
  }

  function ensurePhysics(d,base,off){
    const st={base,angle:base,vel:0,target:base,drag:false,lastX:0,lastT:0,off};
    phys.set(d,st); physDocs.add(d);
    d.style.setProperty("--rot",base+"deg");
    start();
  }

  function start(){
    if(rafOn) return;
    rafOn=true; lastFrame=performance.now();
    requestAnimationFrame(tick);
  }

  function tick(now){
    const dt=Math.min(.033,(now-lastFrame)/1000);
    lastFrame=now;
    let active=false;

    physDocs.forEach(d=>{
      const p=phys.get(d);
      if(!p) return;

      if(d.classList.contains("focused")){
        p.angle=p.base; p.vel=0; p.target=p.base;
      }else{
        const a=(p.target-p.angle)*60 - p.vel*10;
        p.vel+=a*dt; p.angle+=p.vel*dt;
      }

      d.style.setProperty("--rot",p.angle+"deg");

      if(Math.abs(p.vel)>0.05 || Math.abs(p.angle-p.base)>0.02 || p.drag) active=true;
    });

    if(active) requestAnimationFrame(tick);
    else rafOn=false;
  }

  // --- focus / zoom / spotlight ---
  let focused=null;
  let focusPoint=null; // board-local coords {x,y}
  const saved=new Map();
  const save=d=>saved.set(d,{left:parseFloat(d.style.left),top:parseFloat(d.style.top)});

  function applyZoom(on){
    if(!on){
      document.documentElement.style.setProperty("--scale","1");
      document.documentElement.style.setProperty("--tx","0px");
      document.documentElement.style.setProperty("--ty","0px");
      spotlight.classList.remove("on");
      return;
    }
    const scale = 1.2;

    // center focusPoint in viewport
    const cx = viewport.clientWidth / 2;
    const cy = viewport.clientHeight / 2;

    const tx = cx - scale * focusPoint.x;
    const ty = cy - scale * focusPoint.y;

    document.documentElement.style.setProperty("--scale", String(scale));
    document.documentElement.style.setProperty("--tx", `${tx}px`);
    document.documentElement.style.setProperty("--ty", `${ty}px`);

    // spotlight position in viewport coords = scaled board coord + translation
    const spotX = scale * focusPoint.x + tx;
    const spotY = scale * focusPoint.y + ty;
    document.documentElement.style.setProperty("--spotX", `${spotX}px`);
    document.documentElement.style.setProperty("--spotY", `${spotY}px`);

    spotlight.classList.add("on");
  }

  function setFocusPointFromRects(doc){
    // board-local coordinates BEFORE transform math: element rect relative to board rect
    const b = board.getBoundingClientRect();
    const r = doc.getBoundingClientRect();
    focusPoint = {
      x: (r.left - b.left) + r.width/2,
      y: (r.top  - b.top ) + r.height/2
    };
  }

  function toggleFocus(d){
    // Only photos get the newsroom spotlight treatment
    if(!d.classList.contains("doc--photo")) return;

    if(focused){ clearFocus(); return; }

    bringToFront(d);

    focused=d;
    d.classList.add("focused");

    // dim other photos (name card excluded)
    document.querySelectorAll(".doc").forEach(o=>{
      if(o===d) return;
      if(o.classList.contains("doc--name")) return;
      o.classList.add("dimmed");
    });

    // compute focus point, then zoom + spotlight
    setFocusPointFromRects(d);
    applyZoom(true);
  }

  function clearFocus(){
    applyZoom(false);
    document.querySelectorAll(".doc").forEach(d=>{
      d.classList.remove("focused","dimmed");
      const s=saved.get(d);
      if(s){ d.style.left=s.left+"px"; d.style.top=s.top+"px"; }
    });
    focused=null;
    focusPoint=null;
  }

  spotlight.addEventListener("click", clearFocus);
  document.addEventListener("keydown", e => {
    if(e.key === "Escape") clearFocus();
  });

  window.addEventListener("resize", () => {
    if(!focused || !focusPoint) return;
    applyZoom(true);
  });

  // --- dragging ---
  function wire(d){
    let dragging=false,sx,sy,sl,st,moved=false;

    d.addEventListener("pointerdown",e=>{
      if(focused) return;
      e.preventDefault();

      bringToFront(d);

      dragging=true; moved=false;
      sx=e.clientX; sy=e.clientY;
      sl=parseFloat(d.style.left); st=parseFloat(d.style.top);
      d.setPointerCapture(e.pointerId);

      const p=phys.get(d);
      if(p){ p.drag=true; p.lastX=e.clientX; p.lastT=performance.now(); start(); }
    },{passive:false});

    d.addEventListener("pointermove",e=>{
      if(!dragging) return;
      e.preventDefault();

      const dx=e.clientX-sx,dy=e.clientY-sy;
      if(Math.abs(dx)+Math.abs(dy)>6) moved=true;

      d.style.left=clamp(sl+dx,12,innerWidth-d.offsetWidth-12)+"px";
      d.style.top =clamp(st+dy,12,innerHeight-d.offsetHeight-12)+"px";

      const p=phys.get(d);
      if(p){
        const now=performance.now(),dt=Math.max(8,now-p.lastT);
        const vx=(e.clientX-p.lastX)/dt;
        p.lastX=e.clientX; p.lastT=now;

        const lever=.35+p.off*1.15;

        // inertia lag (the version you liked): drag right->left => swings right first
        p.target=p.base+clamp(vx*210*lever,-18,18);
        start();
      }
    },{passive:false});

    d.addEventListener("pointerup",()=>{
      if(dragging) save(d);
      dragging=false;
      const p=phys.get(d);
      if(p){ p.drag=false; p.target=p.base; start(); }
    });

    d.addEventListener("click",()=>{
      if(moved) return;
      bringToFront(d);
      toggleFocus(d);
    });
  }

  // --- create name card ---
  const name=document.createElement("article");
  name.className="doc doc--name";
  name.style.setProperty("--pinX","50%");
  name.style.setProperty("--pin",gray());
  name.innerHTML=`<span class="pin"></span><h1>CEM OZTURK</h1><p>Student, researcher, designer</p>`;
  board.appendChild(name);

  ensurePhysics(name,rand(-2,2),0);

  name.style.left=(innerWidth-name.offsetWidth)/2+"px";
  name.style.top="20px";
  save(name);
  wire(name);

  // --- photos ---
  ["designer1.jpg","designer2.jpg","designer3.jpg"].forEach(src=>{
    const d=document.createElement("article");
    d.className="doc doc--photo";

    const pinX=PIN_X_OPTIONS[Math.floor(Math.random()*3)];
    d.style.setProperty("--pinX",pinX);
    d.style.setProperty("--pin",gray());
    d.innerHTML=`<span class="pin"></span><img src="./assets/${src}">`;
    board.appendChild(d);

    const base=baseAngle(pinX),off=pinOffset(pinX);
    ensurePhysics(d,base,off);

    bringToFront(d);

    const img=d.querySelector("img");
    img.onload=()=>{
      const s=Math.min(120/img.naturalWidth,150/img.naturalWidth,1);
      d.style.width=Math.round(img.naturalWidth*s)+"px";
      d.style.height=Math.round(img.naturalHeight*s)+"px";
      d.style.left=rand(40,innerWidth-d.offsetWidth-40)+"px";
      d.style.top =rand(80,innerHeight-d.offsetHeight-40)+"px";
      save(d);
    };

    wire(d);
  });
})();
</script>

</body>
</html>
