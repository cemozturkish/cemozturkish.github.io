<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Cem Ozturk</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Tinos:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">

<style>
:root{
  --wall:#e6e6e6;
  --wall2:#f2f2f2;

  --paper:#fbfbfb;
  --paper2:#f2f2f2;

  --shadow:0 18px 40px rgba(0,0,0,.22);
  --shadowSoft:0 10px 24px rgba(0,0,0,.16);
}

*{box-sizing:border-box}
html,body{height:100%}

body{
  margin:0;
  overflow:hidden;
  background:
    radial-gradient(900px 700px at 10% 10%, rgba(255,255,255,.75), transparent 60%),
    radial-gradient(800px 600px at 90% 20%, rgba(0,0,0,.08), transparent 55%),
    repeating-linear-gradient(0deg, rgba(0,0,0,.02) 0 2px, transparent 2px 7px),
    linear-gradient(135deg, var(--wall), var(--wall2));
  font-family:"Tinos", serif;
}

.board{
  position:relative;
  width:100vw;
  height:100vh;
}

.focus-dim{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.35);
  opacity:0;
  pointer-events:none;
  transition:opacity .35s ease;
  z-index:80;
}
.focus-dim.on{
  opacity:1;
  pointer-events:auto;
}

.doc{
  position:absolute;
  transform:rotate(var(--rot));
  transform-origin: var(--pinX) 14px;

  transition:
    left .45s cubic-bezier(.22,.61,.36,1),
    top .45s cubic-bezier(.22,.61,.36,1),
    filter .25s ease,
    opacity .25s ease;
  cursor:grab;
  user-select:none;
  touch-action:none;
}
.doc:active{cursor:grabbing}

/* Pin */
.pin{
  position:absolute;
  top:6px;
  left:var(--pinX);
  transform:translateX(-50%);
  width:16px; height:16px;
  border-radius:50%;
  background:var(--pin);
  box-shadow:0 6px 14px rgba(0,0,0,.25);
  pointer-events:none;
  z-index:6;
}
.pin::after{
  content:"";
  position:absolute;
  inset:4px;
  border-radius:50%;
  background:rgba(255,255,255,.55);
}

/* Puncture shadow under pin (photos only) */
.doc--photo::after{
  content:"";
  position:absolute;
  left:var(--pinX);
  top:16px;
  transform:translateX(-50%);
  width:12px;
  height:7px;
  border-radius:999px;
  background:rgba(0,0,0,.16);
  filter:blur(.25px);
  z-index:5;
}

/* Photos */
.doc--photo img{
  display:block;
  width:100%;
  height:100%;
  box-shadow:var(--shadow);
  pointer-events:none;
  -webkit-user-drag:none;
}

/* Name card */
.doc--name{
  background:linear-gradient(180deg, var(--paper), var(--paper2));
  border-radius:999px;
  padding:14px 18px 12px;
  box-shadow:var(--shadowSoft);
  text-align:center;
}
.doc--name h1{
  margin:0;
  font-size:28px;
  letter-spacing:.08em;
}
.doc--name p{
  margin:4px 0 0;
  font-size:13px;
  opacity:.75;
  font-family:system-ui;
}

/* Focus states */
.doc.focused{
  filter:brightness(1.12) contrast(1.05);
  z-index:120;
  cursor:default;
}
.doc.dimmed{opacity:.35}

/* Hint */
.hint{
  position:fixed;
  bottom:14px; right:14px;
  padding:10px 14px;
  border-radius:999px;
  background:rgba(250,250,250,.9);
  font-size:12px;
  font-family:system-ui;
  z-index:60;
}
</style>
</head>

<body>
<div class="focus-dim" id="dim"></div>
<main class="board" id="board"></main>
<div class="hint">Drag · Click to focus · ESC to exit</div>

<script>
(function(){
  const board = document.getElementById("board");
  const dim = document.getElementById("dim");

  const clamp=(v,min,max)=>Math.max(min,Math.min(max,v));
  const rand=(a,b)=>Math.random()*(b-a)+a;

  const PIN_X_OPTIONS = ["16%","50%","84%"];

  function pinPercent(pinX){
    return parseFloat(String(pinX).replace("%","")) || 50;
  }

  // 0 when centered (50%), ~1 at 16%/84%
  function pinOffsetMag(pinX){
    const p = pinPercent(pinX);
    return clamp(Math.abs((p - 50) / 34), 0, 1);
  }

  function randomGrayPin(){
    const g = Math.floor(rand(40, 110));
    return `rgb(${g},${g},${g})`;
  }

  // Equilibrium tilt set by pin offset (left pin -> +deg, right pin -> -deg)
  function baseAngleFromPin(pinX){
    const p = pinPercent(pinX);
    const offset = (p - 50) / 34; // ~-1..+1
    const MAX_TILT = 9.5;
    const base = -offset * MAX_TILT;

    const wobble = (Math.random() - 0.5) * 2 * (0.25 + Math.abs(offset) * 0.9);
    return clamp(base + wobble, -14, 14);
  }

  // --- Wiggle Physics (damped spring) ---
  const phys = new WeakMap();
  const physDocs = new Set();
  let rafOn = false;
  let lastFrame = 0;

  function ensurePhysics(doc, baseAngle, offsetMag){
    const st = {
      base: baseAngle,
      angle: baseAngle,
      vel: 0,
      target: baseAngle,
      dragging: false,
      lastX: 0,
      lastT: 0,
      offsetMag: offsetMag ?? 0
    };
    phys.set(doc, st);
    physDocs.add(doc);
    doc.style.setProperty("--rot", st.angle + "deg");
    startRAF();
    return st;
  }

  function startRAF(){
    if(rafOn) return;
    rafOn = true;
    lastFrame = performance.now();
    requestAnimationFrame(tick);
  }

  function tick(now){
    const dt = Math.min(0.033, (now - lastFrame) / 1000);
    lastFrame = now;

    const STIFFNESS = 60;
    const DAMPING   = 10;

    const STOP_EPS_ANGLE = 0.02;
    const STOP_EPS_VEL   = 0.05;

    let anyActive = false;

    physDocs.forEach(doc=>{
      const st = phys.get(doc);
      if(!st) return;

      if(doc.classList.contains("focused")){
        st.angle = st.base;
        st.vel = 0;
        st.target = st.base;
        doc.style.setProperty("--rot", st.angle + "deg");
        return;
      }

      const acc = (st.target - st.angle) * STIFFNESS - st.vel * DAMPING;
      st.vel += acc * dt;
      st.angle += st.vel * dt;

      doc.style.setProperty("--rot", st.angle + "deg");

      const nearRest =
        Math.abs(st.angle - st.base) < STOP_EPS_ANGLE &&
        Math.abs(st.vel) < STOP_EPS_VEL &&
        !st.dragging;

      if(!nearRest) anyActive = true;
    });

    if(anyActive){
      requestAnimationFrame(tick);
    }else{
      rafOn = false;
    }
  }

  // --- Focus logic ---
  let focused=null;
  const saved=new Map();

  function save(el){
    saved.set(el,{
      left:parseFloat(el.style.left),
      top:parseFloat(el.style.top)
    });
  }

  function toggleFocus(doc){
    if(focused){ clearFocus(); return; }
    focused=doc;
    dim.classList.add("on");
    doc.classList.add("focused");

    const isName = doc.classList.contains("doc--name");
    const fr=doc.getBoundingClientRect();
    const fx=fr.left+fr.width/2;
    const fy=fr.top+fr.height/2;

    document.querySelectorAll(".doc").forEach(d=>{
      if(d===doc) return;
      if(d.classList.contains("doc--name") && !isName) return;
      if(isName) return;

      const o=saved.get(d);
      const r=d.getBoundingClientRect();
      const cx=r.left+r.width/2;
      const cy=r.top+r.height/2;

      let dx=cx-fx, dy=cy-fy;
      const mag=Math.hypot(dx,dy)||1;
      dx/=mag; dy/=mag;

      d.style.left=clamp(o.left+dx*120,12,innerWidth-r.width-12)+"px";
      d.style.top =clamp(o.top +dy*120,12,innerHeight-r.height-12)+"px";
      d.classList.add("dimmed");
    });
  }

  function clearFocus(){
    dim.classList.remove("on");
    document.querySelectorAll(".doc").forEach(d=>{
      d.classList.remove("focused","dimmed");
      const o=saved.get(d);
      if(o){ d.style.left=o.left+"px"; d.style.top=o.top+"px"; }
    });
    focused=null;
  }

  dim.onclick=clearFocus;
  document.onkeydown=e=>e.key==="Escape"&&clearFocus();

  // --- Drag wiring with physics wiggle ---
  function wire(d){
    let dragging=false, sx, sy, sl, st, moved=false;

    d.addEventListener("pointerdown",e=>{
      if(focused) return;
      dragging=true; moved=false;
      sx=e.clientX; sy=e.clientY;
      sl=parseFloat(d.style.left); st=parseFloat(d.style.top);
      d.setPointerCapture(e.pointerId);

      const p = phys.get(d);
      if(p){
        p.dragging = true;
        p.lastX = e.clientX;
        p.lastT = performance.now();
        startRAF();
      }
    });

    d.addEventListener("pointermove",e=>{
      if(!dragging) return;

      const dx=e.clientX-sx, dy=e.clientY-sy;
      if(Math.abs(dx)+Math.abs(dy)>6) moved=true;

      d.style.left=clamp(sl+dx,12,innerWidth-d.offsetWidth-12)+"px";
      d.style.top =clamp(st+dy,12,innerHeight-d.offsetHeight-12)+"px";

      const p = phys.get(d);
      if(p){
        const now = performance.now();
        const dtMs = Math.max(8, now - p.lastT);
        const vx = (e.clientX - p.lastX) / dtMs; // px per ms
        p.lastX = e.clientX;
        p.lastT = now;

        // Scale swing by pin offset: center ~ gentle, sides ~ stronger
        const lever = 0.35 + p.offsetMag * 1.15; // 0.35..1.5

        // Convert speed into angular target.
        // Move right->left (vx negative) => swings right first (positive angle)
        const SPEED_TO_ANGLE = 210;
        const swing = clamp(-vx * SPEED_TO_ANGLE * lever, -18, 18);

        p.target = p.base + swing;
        startRAF();
      }
    });

    d.addEventListener("pointerup",()=>{
      if(dragging) save(d);
      dragging=false;

      const p = phys.get(d);
      if(p){
        p.dragging = false;
        p.target = p.base;   // settle back to equilibrium
        startRAF();
      }
    });

    d.addEventListener("click",()=>{
      if(moved) return;
      toggleFocus(d);
    });
  }

  // --- Create Name card (pin centered, mild wiggle only) ---
  const name=document.createElement("article");
  name.className="doc doc--name";
  name.style.setProperty("--pinX","50%");
  name.style.setProperty("--pin", randomGrayPin());
  name.innerHTML=`<span class="pin"></span><h1>CEM OZTURK</h1><p>Student, researcher, designer</p>`;
  board.appendChild(name);

  const nameBase = rand(-2.0,2.0);
  ensurePhysics(name, nameBase, 0);

  name.style.left=(innerWidth-name.offsetWidth)/2+"px";
  name.style.top="20px";
  save(name);
  wire(name);

  // --- Create Photos ---
  [
    ["./assets/designer1.jpg"],
    ["./assets/designer2.jpg"],
    ["./assets/designer3.jpg"]
  ].forEach(([src])=>{
    const d=document.createElement("article");
    d.className="doc doc--photo";

    const pinX = PIN_X_OPTIONS[Math.floor(Math.random()*PIN_X_OPTIONS.length)];
    const off = pinOffsetMag(pinX);
    const base = baseAngleFromPin(pinX);

    d.style.setProperty("--pinX", pinX);
    d.style.setProperty("--pin", randomGrayPin());
    d.innerHTML=`<span class="pin"></span><img src="${src}" draggable="false">`;
    board.appendChild(d);

    ensurePhysics(d, base, off);

    const img=d.querySelector("img");
    img.onload=()=>{
      const TARGET_WIDTH = 120;
      const MAX_WIDTH = 150;

      const nw=img.naturalWidth;
      const nh=img.naturalHeight;

      const scale=Math.min(TARGET_WIDTH/nw, MAX_WIDTH/nw, 1);
      const w=Math.round(nw*scale);
      const h=Math.round(nh*scale);

      d.style.width=w+"px";
      d.style.height=h+"px";
      d.style.left=rand(40,innerWidth-w-40)+"px";
      d.style.top =rand(80,innerHeight-h-40)+"px";
      save(d);
    };

    wire(d);
  });

})();
</script>

</body>
</html>
